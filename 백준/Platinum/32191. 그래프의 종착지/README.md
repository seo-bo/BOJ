# [Platinum IV] 그래프의 종착지 - 32191 

[문제 링크](https://www.acmicpc.net/problem/32191) 

### 성능 요약

메모리: 18612 KB, 시간: 120 ms

### 분류

방향 비순환 그래프, 다이나믹 프로그래밍, 그래프 이론, 그래프 탐색, 수학, 위상 정렬

### 제출 일자

2024년 9월 3일 04:30:00

### 문제 설명

<p>디미고에서 공부가 너무나도 하기 싫었던 ecode는 야자 시간에 의미 없는 그래프를 그렸다. 어떻게든 자신이 만든 그래프에 의미를 부여하고 싶었던 ecode는 아래와 같은 규칙을 덧붙였다.</p>

<ul>
	<li>그래프의 모든 노드는 번호와 등급이 존재한다.</li>
	<li>같은 등급의 노드 사이에는 간선이 존재하지 않는다.</li>
	<li>$1$등급 노드는 한 개만 존재한다.</li>
	<li>어떤 노드에 연결된 하위 등급의 노드를 "<strong>자식 노드</strong>"라고 하자. 자식 노드가 존재하는 모든 노드는 자식 노드 중 하나를 가리키고 있다.</li>
</ul>

<p>이러한 규칙에 따라 작성한 결과 아래와 같은 그래프를 얻었다.</p>

<p style="text-align: center"><img alt="" src="" style="max-width: 100%" width="500px"></p>

<p>옆에서 이를 지켜보던 ecode의 짝꿍인 oh051525는 이를 한심하게 쳐다보며 말하였다.</p>

<blockquote>
<p>차라리 이 그래프로 게임까지 만들어버리지 그래?</p>
</blockquote>

<p>광기가 서린 ecode는 그녀의 아이디어에 감탄하며 이 그래프로 게임을 만들어버렸다!!</p>

<p>ecode가 만든 게임은 출발 지점에서 시작해 그래프의 간선을 따라 이동하는 게임이다. 게임의 <strong>한 턴</strong>은 다음과 같이 진행된다.</p>

<ul>
	<li>플레이어는 $1$등급 노드에서 시작한다.</li>
	<li>플레이어가 현재 위치한 노드 $v$의 자식 노드가 존재한다면, $v$가 가리키는 자식 노드 $w$의 위치로 이동한 뒤 다음과 같은 규칙으로 $v$가 자신의 자식 노드를 가리키도록 한다.
	<ul>
		<li>$w$의 번호가 $v$의 자식 노드의 번호 중 가장 큰 값이 아니라면, $v$는 $w$보다 큰 번호를 가지는 것들 중 번호가 가장 작은 자식 노드를 가리키게 된다.</li>
		<li>$w$의 번호가 $v$의 자식 노드의 번호 중 가장 큰 값이라면, $v$는 가장 작은 번호를 가진 자식 노드를 가리키게 된다.</li>
	</ul>
	</li>
	<li>플레이어가 현재 위치한 노드 $v$의 자식 노드가 존재하지 않는다면, 턴을 종료한다.</li>
</ul>

<p>ecode는 친구들과의 대결에서 승리하기 위해, $T$번째 턴에 마지막으로 도착한 노드의 번호를 미리 알아내려고 한다. 게임의 답을 최대한 빨리 알고 싶은 ecode를 위해 이를 해결하는 코드를 작성해 보자!</p>

### 입력 

 <p>첫 번째 줄에 노드의 개수 $N$과 간선의 개수 $K$, 작업의 실행 횟수 $T$가 주어진다. $(1\leq N\leq 10^5;$ $0\leq K\leq 3\times 10^5;$ $1\leq T\leq 5\times 10^5)$</p>

<p>두 번째 줄부터 $K$개의 줄에 걸쳐, 간선으로 연결된 두 노드의 번호 $x$와 $y$가 공백으로 구분되어 주어진다.</p>

<p>$K+2$번째 줄에 각 노드의 등급을 나타내는 $N$개의 정수 $A_1, A_2, ..., A_N$가 공백으로 구분되어 주어진다. $A_i$는 $i$번 노드의 등급을 의미한다. $(1\leq A_i\leq 5\times 10^5)$ $1$등급 노드는 항상 한 개 존재한다.</p>

<p>$K+3$번째 줄에 $i$번 노드의 화살표가 가리키는 하위 등급 노드의 번호가 공백으로 구분되어 주어진다. $i$번 노드에 연결된 하위 등급 노드가 없다면 $-1$이 입력된다.</p>

<p>게임의 규칙을 어기는 경우는 입력으로 주어지지 않는다.</p>

### 출력 

 <p>$T$번째 턴에 마지막으로 도착한 노드의 번호를 출력한다.</p>

