# [Platinum II] 마계안암 - 27934 

[문제 링크](https://www.acmicpc.net/problem/27934) 

### 성능 요약

메모리: 29284 KB, 시간: 136 ms

### 분류

방향 비순환 그래프, 데이크스트라, 다이나믹 프로그래밍, 그래프 이론, 그래프 탐색, 강한 연결 요소, 최단 경로, 위상 정렬

### 제출 일자

2024년 8월 24일 09:40:21

### 문제 설명

<p>태윤이는 연세대학교 과잠을 입고 안암 곳곳을 여행하려고 한다.</p>

<p>안암은 $N$개의 건물과 서로 다른 건물들을 잇는 $M$개의 길로 나타낼 수 있다. 안암역은 $1$번 건물이고, 태윤이는 현재 안암역에 있다. 모든 길은 일방통행이고, 0명 이상의 고려대학교 학생들이 존재한다.</p>

<p>태윤이가 어떤 길을 지나가기 위해서는 그 길에 존재하는 고려대학교 학생들의 수만큼 연세빵을 바치고 이동해야 한다. 태윤이는 최소한의 빵을 빼앗기고 안암을 여행하고 싶기 때문에, 안암역에서 시작해서 각각의 건물로 최소한의 빵을 빼앗기고 도달하는 서로 다른 경로의 수를 구하려고 한다. 경로란 안암역에서 출발해 건물에 도착할 때까지 지나간 길들을 순서대로 나열한 것이다. 이때 같은 길을 여러 번 지나갈 수 있다.</p>

<p>안암역에서 시작해서 각 건물까지 최소한으로 빵을 빼앗기고 도착하는 서로 다른 경로의 수를 구해보자. 안암역에서 모든 건물로 도착할 수 있음이 보장된다.</p>

### 입력 

 <p>건물의 개수 $N$이 주어진다. 이어 길의 개수 $M$이 주어진다.</p>

<p>이어 $M$줄에 걸쳐 $i$번째 길의 정보가 $u_i$ $v_i$ $w_i$의 형식으로 주어진다. $i$번째 길을 통해 $u_i$번 건물에서 $v_i$번 건물로 이동할 수 있고, 길에는 $w_i$명의 고려대학교 학생이 존재한다는 뜻이다.</p>

### 출력 

 <p>$N$줄에 걸쳐 각 건물에 최소한으로 빵을 빼앗기고 도착하는 서로 다른 경로의 수를 출력한다. 만약 그러한 경로가 무수히 많다면 <span style="color:#e74c3c;"><code>-1</code></span>을 출력한다. </p>

<p>경로가 무수히 많지 않은 경우에, 경로의 수가 매우 클 수 있으므로 $998\,244\,353$로 나눈 나머지를 출력한다.</p>

